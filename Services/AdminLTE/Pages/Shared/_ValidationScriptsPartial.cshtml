<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
<!--FileIndex-->
<!--MainScript-->
<script src="~/plugins/jquery/jquery.min.js"></script>

<script src="~/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

<script src="~/plugins/ekko-lightbox/ekko-lightbox.min.js"></script>

<script src="~/dist/js/adminlte.min.js"></script>

<script src="~/plugins/filterizr/jquery.filterizr.min.js"></script>
<script src="~/dist/js/demo.js"></script>
<!--ModalInformation-->
<script>
    $(function () {
        $(document).on('click', '[data-toggle="lightbox"]', function (event) {
            event.preventDefault();
            $(this).ekkoLightbox({
                alwaysShowClose: true
            });
        });

        $('.filter-container').filterizr({ gutterPixels: 3 });
        $('.btn[data-filter]').on('click', function () {
            $('.btn[data-filter]').removeClass('active');
            $(this).addClass('active');
        });
        // Handle file click to populate modal
        $('.filtr-item a').on('click', function () {
            var fileData = $(this).data();
            $('#fileUploadedOn').text(fileData.uploadedon);
            $('#fileUploadedBy').text(fileData.uploadedby);
            $('#fileId').val(fileData.fileid);
            $('#galleryId').val(fileData.galleryid);
            $('#fileName').text(fileData.name);
            $('#fileNameHidden').val(fileData.name);
            $('#fileFileType').text(fileData.filetype);
            $('#fileFileTypeHidden').val(fileData.filetype);
            $('#fileSize').text(fileData.size);
            $('#fileSizeHidden').val(fileData.size);
            $('#fileLength').text(fileData.filelength);
            $('#fileLengthHidden').val(fileData.filelength);
            $('#fileImagewidth').text(fileData.fileimagewidth);
            $('#fileImageWidthHidden').val(fileData.fileimagewidth);
            $('#fileImageHeight').text(fileData.fileimageheight);
            $('#fileImageHeightHidden').val(fileData.fileimageheight);
            $('#fileImageAlternativeText').val(fileData.fileimagealternativetext);
            $('#fileTitle').val(fileData.filetitle);
            $('#fileCaption').val(fileData.caption);
            $('#fileDescription').val(fileData.description);
            $('#fileFileUrl').val(fileData.path);
            $('#fileMimeType').val(fileData.mimetype);
            $('#fileMetaDeta').val(fileData.metadeta);
            var previewContainer = $('#filePreviewContainer');
            previewContainer.empty();
            // Hide all file-specific sections initially
            $('#imageDimensions').hide();
            $('#fileLengthSection').hide();
            $('#imageFields').hide();
            if (fileData.filetype === 'image') {
                previewContainer.html('<img src="' + fileData.path + '" class="img-fluid" alt="Image Preview">');
                $('#imageDimensions').show();
                $('#imageFields').show();
                $('#fileImageWidth').text(fileData.fileImagewidth + 'px');
                $('#fileImageHeight').text(fileData.fileImageHeight + 'px');
                $('#fileImageAlternativeText').val(fileData.fileImageAlternativeText || 'N/A');
            } 
            else if (fileData.filetype === 'video') {

                $('#fileLengthSection').show();
                $('#fileLength').text(fileData.fileLength || 'N/A');

                previewContainer.html('<video class="img-fluid" controls><source src="' + fileData.path + '" type="video/mp4">Your browser does not support the video tag.</video>');
            } 
            else if (fileData.filetype === 'audio') {
                $('#fileLengthSection').show();
                $('#fileLength').text(fileData.fileLength || 'N/A');

                previewContainer.html('<audio class="img-fluid" style="width: 1000px; height: 50px; " controls><source src="' + fileData.path + '" type="audio/mp3">Your browser does not support the audio tag.</audio>');
            } 
            else {
                previewContainer.html('<iframe src="' + fileData.path + '" width="100%" height="400px"></iframe>');
            }

            $('#fileModal').modal('show');
        });
    })
</script>
<!--ModalInformation-->
<!--Select Item-->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Get all category filter buttons
        const categoryFilters = document.querySelectorAll('.btn-group.w-100.mb-2 a[data-filter]');

        // Add click event listeners to category filter buttons
        categoryFilters.forEach(filter => {
            filter.addEventListener('click', function () {
                const category = this.getAttribute('data-filter'); // Get the category value (1, 2, 3, 4, or 'all')
                const checkboxes = document.querySelectorAll('.filtr-item input[type="checkbox"]');

                checkboxes.forEach(checkbox => {
                    const itemCategory = checkbox.closest('.filtr-item').getAttribute('data-category');

                    // If the category matches or it's 'all', toggle the checkbox
                    if (category === 'all' || itemCategory === category) {
                        checkbox.checked = this.querySelector('input[type="checkbox"]').checked;
                    }
                });
            });
        });
    });
</script>
<!--Select Item-->
<!--Get Ids of selected items-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<script>
    document.getElementById('deleteFilesBtn').addEventListener('click', function (event) {

        event.preventDefault();

        const selectedFiles = [];
        //document.querySelectorAll('.filtr-item input[type="checkbox"]:checked').forEach(checkbox => {
          //  const fileId = checkbox.closest('.filtr-item').getAttribute('data-fileId');
        document.querySelectorAll('.btn.btn-info.active').forEach(activeElement => {
            const fileId = activeElement.getAttribute('data-filter'); // Assuming 'data-filter' holds the file ID

          if (fileId) {
                selectedFiles.push(fileId);
            }
        });

        if (selectedFiles.length === 0) {
            alert('No files selected!');
            return;
        }
        console.log(selectedFiles)
        document.getElementById('selectedFileIds').value = selectedFiles.join(',');

        // Submit the form
        document.getElementById('deleteFilesForm').submit();
    });
</script>
<!--Get Ids of selected items-->
<!--MainScript-->
<!--clipboardScript-->
<script>
    // Function to handle copy to clipboard
    function copyToClipboard(inputId) {
        const copyText = document.getElementById(inputId);
        copyText.select();
        copyText.setSelectionRange(0, 99999); // For mobile devices
        navigator.clipboard.writeText(copyText.value)
            .then(() => {
                console.error('done copy: ', err);
            })
            .catch(err => {
                console.error('Failed to copy: ', err);
            });
    }
    // Add event listeners for each copy button
    document.getElementById('fileCopyButton').addEventListener('click', function () {
        copyToClipboard('fileFileUrl');
    });
</script>
<!--clipboardScript-->
<!--CreateFileValidatio-->
<script>
    function validateFile() {
        let fileType = document.getElementById("fileType").value.toLowerCase();
        let fileInput = document.getElementById("fileInput");
        let fileTypeError = document.getElementById("fileTypeError");
        let fileError = document.getElementById("fileError");

        // Reset errors
        fileTypeError.style.display = "none";
        fileError.style.display = "none";

        // Validate file type selection
        if (!fileType) {
            fileTypeError.style.display = "block";
            return false;
        }

        // Validate uploaded file
        if (fileInput.files.length > 0) {
            let allowedExtensions = {
                "image": ["jpg", "jpeg", "png", "gif"],
                "pdf": ["pdf"],
                "word": ["doc", "docx"],
                "excel": ["xls", "xlsx"]
            };

            let fileName = fileInput.files[0].name;
            let fileExtension = fileName.split('.').pop().toLowerCase();

            if (!allowedExtensions[fileType].includes(fileExtension)) {
                fileError.style.display = "block";
                return false;
            }
        } else {
            fileError.style.display = "block";
            return false;
        }

        return true;
    }
    function toggleAltTextField() {
        let fileType = document.getElementById("fileType").value.toLowerCase();
        let altTextContainer = document.getElementById("altTextContainer");

        if (fileType === "image") {
            altTextContainer.style.display = "block";
        } else {
            altTextContainer.style.display = "none";
        }
    }
</script>
<!--CreateFileValidatio-->
